## 产品需求文档 (PRD)

#### 概述

本产品旨在通过跟踪和分析页面访问量（Page Views，简称 PV）提供准确全面的网站分析服务。系统将监测用户行为模式，识别受欢迎的页面和潜在问题，并提出改进用户体验和提高转化率的优化建议。

##### 术语解释

页面访问量 (PV)
页面访问量表示网页在浏览器中加载实例的数量。每当用户打开或刷新网页时，就会计算一次 PV。

用户行为分析
用户行为分析涉及研究用户如何与网站互动，包括导航模式、页面停留时间、跳出率、滚动深度、交互行为、设备类型和浏览器分布等方面。

##### 功能

总 PV 计数： 显示网站上的总 PV 数量。
每日/每周/每月 PV 趋势： 显示每日、每周和每月的 PV 趋势，了解随着时间推移的使用模式。
页面级 PV： 显示每个页面的 PV 数量，识别最受欢迎的页面。
来源/媒介 PV： 显示来自不同来源和媒介的 PV 数量，了解流量来源。
用户行为分析： 分析用户行为模式，包括页面访问路径、页面停留时间、跳出率、滚动深度、交互行为、设备类型和浏览器分布等方面。
用户流程
系统捕获并存储 PV 数据。
数据被处理和分析以生成报告。
报告以用户友好的格式显示，允许利益相关者审查和解读数据。
根据报告获得的洞察力，利益相关者可以做出明智决策优化网站和改善用户体验。

#### 需求

用户行为分析：通过统计用户每天访问最频繁的页面、总页面浏览量、平均停留时长、不同页面访问次数等，可以深入理解用户的行为模式和兴趣偏好。

用户体验优化：平均停留时长可用来评估页面内容的质量和吸引力，有助于改进页面设计和布局，提升用户体验。

设备与平台适配：通过收集并分析用户使用的操作系统平台和屏幕分辨率分布，可以针对性地优化产品在不同设备和平台上的表现，确保兼容性和体验一致性。

精细化运营：基于每日聚合数据，企业可以更精准地制定运营策略，例如针对高活跃用户推送相关活动或消息，或者根据用户的浏览习惯进行个性化推荐。

#### 实施细节

系统将使用 JavaScript 捕获和发送 PV 数据到服务器进行处理和存储。后台数据库将存储原始数据，报告引擎将根据存储的数据生成报告。报告将以 Markdown 格式保存，并可通过自动化过程导出成 HTML 或 PDF 格式。此外，还可以通过 API 获取报告数据，以便与其他系统集成。

#### 何时生产数据到IndexedDB?

    有几个触发时机：
    1、页面初始化（load/pageshow）
    2、路由或者浏览器地址发生变化(pushState/replaceState/hashChange/popState)
    3、Error captured 捕获到错误的时候

#### 秒开率计算
计算网页的秒开率主要依赖于性能指标监测，特别是Largest Contentful Paint (LCP) 和 First Input Delay (FID)，以及其他可能影响用户感知页面加载速度的因素。以下是一种基于LCP的秒开率计算方法的简化流程：

收集性能数据： 利用浏览器性能API（如PerformanceObserver）收集每次页面加载时的LCP时间戳。

定义阈值： 设定一个阈值，比如1000毫秒（1秒），作为判断网页是否“秒开”的依据。

计算秒开次数： 统计在规定时间内（1秒内）完成LCP的页面访问次数。

计算总访问次数： 计算一段时间内总的页面访问次数。

计算秒开率： 秒开率 = （在1秒内完成LCP的页面访问次数 / 总访问次数）× 100%

例如，如果有1000次页面访问，其中800次在1秒内完成了LCP，则秒开率为80%。